import{q as N,r as a,j as e}from"./index-pa_thSCV.js";import{C as c,a as r}from"./CRow-C3S0_Vw6.js";import{C as T,a as E}from"./CCardBody-GxEf9Cn3.js";import{C as I}from"./CCardHeader-DlNUx34W.js";import{C as b}from"./CForm-NXa-OVrg.js";import{C as m}from"./CFormLabel-CMaJqg25.js";import{C}from"./CFormInput-DIoOgNae.js";import{C as k}from"./CFormSelect-BnKiXsSP.js";import{C as F}from"./CFormTextarea-By3_EK4u.js";import{a as A}from"./index.esm-Dz0yT19O.js";import{C as R,a as D,b as j,c as h,d as B,e as l}from"./CTable-5Z20koPP.js";import"./CFormControlWrapper-DllR3RVu.js";import"./CFormControlValidation-D9fpJgZl.js";const Q=()=>{const u=N();a.useEffect(()=>{localStorage.getItem("token")||u("/login")},[u]);const[i,d]=a.useState({employeeId:"",employeeName:"",shiftType:"",notes:""}),[g,S]=a.useState([]),[p,f]=a.useState([]);a.useEffect(()=>{const t=localStorage.getItem("token");t?fetch("https://hospital-management-server-nu.vercel.app/api/employee-records",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(o=>o.json()).then(o=>S(o)).catch(o=>console.error("Error fetching employee records:",o)):console.error("No token found!")},[]),a.useEffect(()=>{const t=localStorage.getItem("token");t?fetch("https://hospital-management-server-nu.vercel.app/api/shifts",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(o=>o.json()).then(o=>{o&&o.data&&Array.isArray(o.data)?f(o.data):(console.error("Invalid data structure",o),f([]))}).catch(o=>console.error("Error fetching shift records:",o)):console.error("No token found!")},[]);const x=t=>{const{name:o,value:s}=t.target;if(d(n=>({...n,[o]:s})),o==="employeeId"){const n=g.find(y=>y.employeeId===s);d(y=>({...y,employeeName:n?n.name:""}))}},v=()=>{const t={...i,shiftId:Math.random().toString(36).substr(2,9)},o=localStorage.getItem("token");o?fetch("https://hospital-management-server-nu.vercel.app/api/shift",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(t)}).then(s=>s.json()).then(s=>{s&&s.message==="Shift record saved successfully!"&&(f(n=>[...n,t]),d({employeeId:"",employeeName:"",shiftType:"",notes:""}),alert("Shift record saved successfully!"))}).catch(s=>console.error("Error saving shift record:",s)):console.error("No token found!")};return e.jsx(c,{children:e.jsx(r,{xs:12,children:e.jsxs(T,{className:"mb-4",children:[e.jsx(I,{children:e.jsx("strong",{children:"Shift Management"})}),e.jsxs(E,{children:[e.jsxs(b,{children:[e.jsxs(c,{children:[e.jsxs(r,{md:6,children:[e.jsx(m,{htmlFor:"employeeId",children:"Employee ID"}),e.jsx(C,{type:"text",id:"employeeId",name:"employeeId",value:i.employeeId,onChange:x,placeholder:"Enter employee ID"})]}),e.jsxs(r,{md:6,children:[e.jsx(m,{htmlFor:"employeeName",children:"Employee Name"}),e.jsx(C,{type:"text",id:"employeeName",name:"employeeName",value:i.employeeName,readOnly:!0,placeholder:"Employee name will be auto-filled"})]})]}),e.jsxs(c,{className:"mt-3",children:[e.jsxs(r,{md:6,children:[e.jsx(m,{htmlFor:"shiftType",children:"Shift Type"}),e.jsxs(k,{id:"shiftType",name:"shiftType",value:i.shiftType,onChange:x,children:[e.jsx("option",{value:"",children:"Select Shift Type"}),e.jsx("option",{value:"morning",children:"Morning Shift"}),e.jsx("option",{value:"evening",children:"Evening Shift"}),e.jsx("option",{value:"night",children:"Night Shift"})]})]}),e.jsxs(r,{md:6,children:[e.jsx(m,{htmlFor:"notes",children:"Additional Notes"}),e.jsx(F,{id:"notes",name:"notes",value:i.notes,onChange:x,rows:"3",placeholder:"Enter any additional notes"})]})]}),e.jsx(c,{className:"mt-4",children:e.jsx(r,{md:2,children:e.jsx(A,{color:"primary",onClick:v,children:"Save Shift"})})})]}),e.jsx(c,{className:"mt-5",children:e.jsx(r,{xs:12,children:e.jsxs(R,{striped:!0,children:[e.jsx(D,{children:e.jsxs(j,{children:[e.jsx(h,{children:"#"}),e.jsx(h,{children:"Employee ID"}),e.jsx(h,{children:"Employee Name"}),e.jsx(h,{children:"Shift Type"}),e.jsx(h,{children:"Notes"})]})}),e.jsx(B,{children:Array.isArray(p)&&p.length>0?p.map((t,o)=>e.jsxs(j,{children:[e.jsx(l,{children:o+1}),e.jsx(l,{children:t.employeeId}),e.jsx(l,{children:t.employeeName}),e.jsx(l,{children:t.shiftType}),e.jsx(l,{children:t.notes})]},t._id)):e.jsx(j,{children:e.jsx(l,{colSpan:"5",className:"text-center",children:"No shift records available."})})})]})})})]})]})})})};export{Q as default};
